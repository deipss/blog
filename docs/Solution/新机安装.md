---
layout: default
title: 新机安装
parent: Solution
last_modified_date: 2025-07-05
---

安装一台新的Ubuntu机器，从硬件到软件，这里主要是给出软件

# ssh安装 

```text
sudo apt update
sudo apt install openssh-server
sudo systemctl status ssh
sudo systemctl enable ssh
sudo ufw allow ssh
```

# nvidia驱动 
https://linuxconfig.org/how-to-install-the-nvidia-drivers-on-ubuntu-22-04

Open the `Software & Updates` application window.
Select TAB `Additional Drivers` and choose any proprietary NVIDIA driver.
The higher the driver number the latest the version.

# v2ray 

https://github.com/v2fly/v2ray-core/releases/tag/v4.31.0

```text
v2ray -h
Command 'v2ray' not found, but can be installed with:
sudo snap install v2ray  # version 2.37, or
sudo apt  install v2ray  # version 4.34.0-5
See 'snap info v2ray' for additional versions.
```
这个错误说明你配置了不兼容的组合：

```
VLESS users: "flow" doesn't support "xtls-rprx-vision" in this version
exit status 255
```

---

## 🔍 关键点解析

* 协议：VLESS
* 传输层：`tls`（或 `xtls`）
* flow 设置：`xtls-rprx-vision`

这三个中，**flow 设置是和 XTLS 的特定实现相关的字段**。VLESS 的 `flow` 参数只有在某些前置条件满足时才能使用，**而你使用的 V2Ray 内核版本并不支持 `xtls-rprx-vision`**。

---

## ✅ 解决方案

### ✅ 方式 1：**升级 V2Ray 内核**

`xtls-rprx-vision` 是 **XTLS v2 (Real Proxy Vision)** 的一种传输机制，目前只在 **某些魔改版 V2Ray** 中（比如 **sing-box** 或者 **某些第三方 XTLS 实现**) 支持。

如果你使用的是官方 `v2ray-core`，是不支持这个参数的。

#### ✅ 正确选择：

* 官方 V2Ray → ❌ 不支持 `xtls-rprx-vision`
* 推荐使用 **Xray-core**（V2Ray 的魔改版本） → ✅ 支持该 flow

👉 [Xray-core GitHub](https://github.com/XTLS/Xray-core)

> 安装 Xray-core 来替代 v2ray-core 可解决这个问题。

---

### ✅ 方式 2：**使用官方支持的 flow 设置（或者删除它）**

你可以改成官方 v2ray-core 支持的传输组合，例如：

#### 示例：使用 `tls` 而非 `xtls`，并去掉 `flow` 字段

```json
"inbounds": [
  {
    "port": 443,
    "protocol": "vless",
    "settings": {
      "clients": [
        {
          "id": "UUID",
          "level": 0
          // 不要加 "flow": "xtls-rprx-vision"
        }
      ],
      "decryption": "none"
    },
    "streamSettings": {
      "network": "tcp",
      "security": "tls",
      "tlsSettings": {
        "certificates": [
          {
            "certificateFile": "/path/to/fullchain.pem",
            "keyFile": "/path/to/privkey.pem"
          }
        ]
      }
    }
  }
]
```

It occur when take solution 2,so that version you installed should be matched with plan above.
```text

2025/07/05 22:24:00 [Info] [3481934723] v2ray.com/core/proxy/vless/outbound: tunneling request to tcp:github.com:443 via tcp:vmess.yahyav2rayssr.top:2053
2025/07/05 22:24:01 [Warning] [3481934723] v2ray.com/core/app/proxyman/outbound: failed to process outbound traffic > v2ray.com/core/proxy/vless/outbound: connection ends > v2ray.com/core/proxy/vless/outbound: failed to decode response header > v2ray.com/core/proxy/vless/encoding: failed to read response version > EOF
2025/07/05 22:24:01 [Info] [3481934723] v2ray.com/core/app/proxyman/inbound: connection ends > v2ray.com/core/proxy/socks: connection ends > v2ray.com/core/proxy/socks: failed to transport all TCP response > io: read/write on closed pipe
```
---

## ✅ 推荐总结

| 方法             | 操作建议                                             |
| -------------- | ------------------------------------------------ |
| ✅ 换用 Xray-core | 支持 `xtls-rprx-vision`，可完整使用该 flow                |
| ✅ 移除 `flow` 字段 | 如果你继续使用 v2ray-core，请移除 `flow`，或者使用 TLS 模式替代 XTLS |

---

如果你不确定当前使用的是哪个版本（v2ray 还是 xray），运行：

```bash
v2ray -version
```



# 1panel

# docker

# 开发

[x] jetbrain
[x] idea
[x] pycharm
[x] vscode
[ ] 对应的插件安装
[x] trae (暂时没有linux发行版)

[x] conda 
[ ] node


[ ] conda env
[ ] v2ray的安装


 
